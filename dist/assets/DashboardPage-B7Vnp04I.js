import{r as s,j as e,a as k}from"./vendor-react-BShjbBE1.js";import{u as S,a as T}from"./index-Dx8A60Sx.js";import{u as C}from"./useApiCache-DNLFDV80.js";import{g as R}from"./shared-services-ARmQ2z6X.js";import"./vendor-router-BBek9TLU.js";const $=s.memo(function({widget:t,isSelected:r,onClick:u}){const i=parseFloat(t.change),l=i>0,o=i===0;return e.jsxs("div",{onClick:()=>u(t.id),style:{padding:"20px",borderRadius:"12px",backgroundColor:r?"#eff6ff":"white",border:`1px solid ${r?"#3b82f6":"#e5e7eb"}`,cursor:"pointer",transition:"all 0.15s ease",boxShadow:r?"0 0 0 2px rgba(59, 130, 246, 0.3)":"0 1px 3px rgba(0, 0, 0, 0.05)"},children:[e.jsx("div",{style:{fontSize:"13px",color:"#6b7280",marginBottom:"4px"},children:t.title}),e.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:"#111827",marginBottom:"8px"},children:t.value}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"13px"},children:[e.jsxs("span",{style:{color:o?"#6b7280":l?"#059669":"#dc2626",fontWeight:"500"},children:[l?"↑":o?"→":"↓"," ",Math.abs(i),"%"]}),e.jsx("span",{style:{color:"#9ca3af"},children:t.period})]})]})},(p,t)=>p.widget.id===t.widget.id&&p.widget.value===t.widget.value&&p.widget.change===t.widget.change&&p.isSelected===t.isSelected),z=s.memo(function({renderMetrics:t}){return e.jsxs("div",{style:{padding:"16px",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[e.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"15px",color:"#374151"},children:"Component Performance"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"12px"},children:[e.jsx(b,{label:"Render Count",value:t.renderCount,unit:"renders"}),e.jsx(b,{label:"Last Render",value:t.lastRenderTime,unit:"ms",warn:t.lastRenderTime>16}),e.jsx(b,{label:"Avg Render",value:t.avgRenderTime,unit:"ms",warn:t.avgRenderTime>16}),t.fcp!==null&&e.jsx(b,{label:"FCP",value:t.fcp,unit:"ms",warn:t.fcp>2500}),t.lcp!==null&&e.jsx(b,{label:"LCP",value:t.lcp,unit:"ms",warn:t.lcp>4e3}),t.cls!==null&&e.jsx(b,{label:"CLS",value:t.cls,unit:"",warn:t.cls>.1})]})]})}),b=s.memo(function({label:t,value:r,unit:u,warn:i=!1}){return e.jsxs("div",{style:{padding:"10px",backgroundColor:"white",borderRadius:"6px",border:`1px solid ${i?"#fecaca":"#e5e7eb"}`},children:[e.jsx("div",{style:{fontSize:"11px",color:"#6b7280",marginBottom:"2px"},children:t}),e.jsxs("div",{style:{fontSize:"18px",fontWeight:"600",color:i?"#dc2626":"#111827"},children:[r,e.jsx("span",{style:{fontSize:"11px",fontWeight:"400",color:"#9ca3af",marginLeft:"2px"},children:u})]})]})}),E=s.memo(function(){const{connected:t,authenticated:r,reconnecting:u,reconnectAttempt:i}=S();let l="disconnected",o="#ef4444",h="Disconnected";return u?(l="reconnecting",o="#f59e0b",h=`Reconnecting (${i})...`):t&&r?(l="connected",o="#10b981",h="Live"):t&&(l="authenticating",o="#f59e0b",h="Authenticating..."),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",borderRadius:"20px",backgroundColor:`${o}15`,border:`1px solid ${o}30`},role:"status","aria-label":`Connection status: ${h}`,children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:o,animation:l==="reconnecting"?"pulse 1s ease-in-out infinite":"none"}}),e.jsx("span",{style:{fontSize:"12px",color:o,fontWeight:"500"},children:h}),e.jsx("style",{children:`
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
      `})]})}),L=20,W=s.memo(function({filter:t=""}){const[r,u]=s.useState(1),{data:i,isLoading:l}=C(()=>R(`/users?page=${r}&limit=50`),{cacheKey:`datagrid-users-${r}`,strategy:"cache-first",ttl:3e4}),o=s.useMemo(()=>{if(!(i!=null&&i.data))return[];if(!t)return i.data;const n=t.toLowerCase();return i.data.filter(x=>x.name.toLowerCase().includes(n)||x.email.toLowerCase().includes(n)||x.role.toLowerCase().includes(n))},[i,t]),h=s.useMemo(()=>o.slice(0,L),[o]),m=s.useCallback(()=>{u(n=>n+1)},[]),a=s.useCallback(()=>{u(n=>Math.max(1,n-1))},[]);return l&&!i?e.jsx("div",{style:{padding:"20px",color:"#6b7280"},children:"Loading grid data..."}):e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",overflow:"hidden"},children:[e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[e.jsx("th",{style:y,children:"Name"}),e.jsx("th",{style:y,children:"Email"}),e.jsx("th",{style:y,children:"Role"}),e.jsx("th",{style:y,children:"Status"}),e.jsx("th",{style:y,children:"Tasks"})]})}),e.jsxs("tbody",{children:[h.map(n=>e.jsx(D,{user:n},n.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{padding:"20px",textAlign:"center",color:"#6b7280"},children:t?"No matching results":"No data available"})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",borderTop:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:[e.jsxs("span",{style:{fontSize:"13px",color:"#6b7280"},children:["Showing ",h.length," of ",o.length," rows (page ",r,")"]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:a,disabled:r===1,style:v,children:"Previous"}),e.jsx("button",{onClick:m,style:v,children:"Next"})]})]})]})}),D=s.memo(function({user:t}){var u;const r={active:"#059669",inactive:"#6b7280",away:"#d97706",busy:"#dc2626"};return e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:j,children:t.name}),e.jsx("td",{style:j,children:t.email}),e.jsx("td",{style:j,children:e.jsx("span",{style:{padding:"2px 8px",borderRadius:"12px",backgroundColor:"#f3f4f6",fontSize:"12px"},children:t.role})}),e.jsx("td",{style:j,children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",fontSize:"13px",color:r[t.status]||"#6b7280"},children:[e.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:r[t.status]||"#6b7280"}}),t.status]})}),e.jsx("td",{style:j,children:((u=t.metrics)==null?void 0:u.tasksCompleted)||0})]})}),y={padding:"10px 16px",textAlign:"left",fontWeight:"600",color:"#374151",borderBottom:"1px solid #e5e7eb",fontSize:"13px"},j={padding:"10px 16px",color:"#4b5563"},v={padding:"6px 12px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"white",cursor:"pointer",fontSize:"12px",color:"#374151"};function I(p="Unknown"){const[t,r]=s.useState({renderCount:0,lastRenderTime:0,avgRenderTime:0,fcp:null,lcp:null,cls:null}),u=s.useRef(0),i=s.useRef([]),l=s.useRef(null);u.current++;const o=performance.now();s.useEffect(()=>{const a=performance.now()-o;i.current.push(a),i.current.length>50&&i.current.shift(),l.current||(l.current=setTimeout(()=>{l.current=null;const n=i.current,x=n.length>0?n.reduce((c,g)=>c+g,0)/n.length:0,d=n.length>0?n[n.length-1]:0;r(c=>({...c,renderCount:u.current,lastRenderTime:Math.round(d*100)/100,avgRenderTime:Math.round(x*100)/100}))},1e3))}),s.useEffect(()=>()=>{l.current&&(clearTimeout(l.current),l.current=null)},[]),s.useEffect(()=>{const a=[];try{const n=new PerformanceObserver(x=>{const d=x.getEntries();d.length>0&&r(c=>({...c,fcp:Math.round(d[0].startTime)}))});n.observe({type:"paint",buffered:!0}),a.push(n)}catch{}try{const n=new PerformanceObserver(x=>{const d=x.getEntries();if(d.length>0){const c=d[d.length-1];r(g=>({...g,lcp:Math.round(c.startTime)}))}});n.observe({type:"largest-contentful-paint",buffered:!0}),a.push(n)}catch{}try{let n=0;const x=new PerformanceObserver(d=>{for(const c of d.getEntries())c.hadRecentInput||(n+=c.value);r(c=>({...c,cls:Math.round(n*1e3)/1e3}))});x.observe({type:"layout-shift",buffered:!0}),a.push(x)}catch{}return()=>{a.forEach(n=>n.disconnect())}},[]);const h=s.useCallback(a=>{performance.mark(`${p}:${a}`)},[p]),m=s.useCallback((a,n,x)=>{try{const d=p;performance.measure(`${d}:${a}`,`${d}:${n}`,`${d}:${x}`);const c=performance.getEntriesByName(`${d}:${a}`);return c.length>0?c[c.length-1].duration:null}catch{return null}},[p]);return{metrics:t,mark:h,measure:m}}const P=s.memo(function(){const{metrics:t,mark:r,measure:u}=I("Dashboard"),{trackRender:i}=T(),[l,o]=s.useState(null),[h,m]=s.useState("");k.useEffect(()=>{i("Dashboard",t.lastRenderTime)},[t.lastRenderTime,i]);const{data:a,isLoading:n,refetch:x}=C(()=>R("/dashboard"),{cacheKey:"dashboard-widgets",strategy:"stale-while-revalidate",ttl:15e3,tags:["dashboard"]}),d=s.useCallback(f=>{r("widget-click-start"),o(f),r("widget-click-end"),u("widget-click","widget-click-start","widget-click-end")},[r,u]),c=s.useCallback(f=>{s.startTransition(()=>{m(f.target.value)})},[]),g=s.useMemo(()=>{var f;return((f=a==null?void 0:a.data)==null?void 0:f.widgets)||[]},[a]);return e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"24px",color:"#111827"},children:"Dashboard"}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx(E,{}),e.jsx("button",{onClick:x,style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px"},children:"Refresh"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"16px",marginBottom:"24px"},children:[g.map(f=>e.jsx($,{widget:f,isSelected:l===f.id,onClick:d},f.id)),n&&g.length===0&&Array.from({length:6},(f,w)=>e.jsx("div",{style:{height:"140px",backgroundColor:"#f3f4f6",borderRadius:"8px",animation:"pulse 1.5s ease-in-out infinite"}},`skeleton-${w}`))]}),e.jsx(z,{renderMetrics:t}),e.jsxs("div",{style:{marginTop:"24px"},children:[e.jsx("div",{style:{marginBottom:"12px"},children:e.jsx("input",{type:"text",placeholder:"Filter data...",value:h,onChange:c,style:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",width:"250px"}})}),e.jsx(W,{filter:h})]})]})});function M(){return e.jsx(P,{})}export{M as default};
//# sourceMappingURL=DashboardPage-B7Vnp04I.js.map
